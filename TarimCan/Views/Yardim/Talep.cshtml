@using TarimCan.Models
@using TarimCan.Helper

@model KullaniciModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="col-md-12">
    <div class="portlet light bordered">
        <div class="portlet-title">
            <div class="caption">
                <i class="icon-equalizer font-red-sunglo"></i>
                <span class="caption-subject font-red-sunglo bold uppercase">HAYVAN SAMAN VE YEM TALEP</span>
            </div>
        </div>

        <div class="portlet-body form">
            <div class="form-horizontal">

                <div class="form-group">
                    <label class="col-md-3 control-label">Adres İl</label>
                    <div class="col-md-4">
                        @Html.DropDownList("SehirId", new SelectList(ViewBag.Sehirler, "Value", "Text"), "Seçiniz", new { @class = "form-control col-md-2", @onchange = "AdresIlChanged(this.value)" })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label">Adres İlçe</label>
                    <div class="col-md-4">
                        <select id="IlceId" class="form-control" onchange="AdresIlceChanged(this.value)">
                            <option value="0">İl Seçiniz</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label">Adres Mahalle</label>
                    <div class="col-md-4">
                        <select id="MahalleId" class="form-control">
                            <option value="0">İlçe Seçiniz</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label">İsim Soyisim</label>
                    <div class="col-md-4">
                        <input type="text" id="IsimSoyisim" class="form-control" autocomplete="off" maxlength="100" placeholder="isim soyisim">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label">Cep Telefonu</label>
                    <div class="col-md-4">
                        <input type="text" id="CepTelefonu" class="form-control" autocomplete="off" maxlength="100" placeholder="cep telefonu">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label">İşletme Adı</label>
                    <div class="col-md-4">
                        <input type="text" id="IsletmeAdi" class="form-control" autocomplete="off" maxlength="100" placeholder="işletme adı">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label">İşletme Kayıt No</label>
                    <div class="col-md-4">
                        <input type="text" id="IsletmeKayitNo" class="form-control" autocomplete="off" maxlength="100" placeholder="işletme kayıt no">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-3 control-label">Yemi Yiyecek Hayvan Cinsi</label>
                    <div class="col-md-4">
                        <select id="HayvanCinsi" class="form-control">
                            <option value="0">Seçiniz</option>
                            <option value="buyukbas">Büyükbaş</option>
                            <option value="kucukbas">Küçükbaş</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-3 control-label">Talep Edilen Kaba Yem Cinsi / Miktari (TON) </label>
                    <div class="col-md-2">
                        <input type="text" id="KabaYemCinsi" class="form-control" autocomplete="off" maxlength="50" placeholder="kaba yem adı">
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="KabaYemMiktari" class="form-control" autocomplete="off" maxlength="2" placeholder="kaba yem miktarı">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-3 control-label">Talep Edilen Kesif Yem Çeşidi / Miktari (Kg)</label>
                    <div class="col-md-2">
                        <input type="text" id="KesifYemCinsi" class="form-control" autocomplete="off" maxlength="50" placeholder="kesif yem adı">
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="KesifYemMiktari" class="form-control" autocomplete="off" maxlength="2" placeholder="kesif yem miktarı">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-3 control-label">Hayvan Talebi / Adedi</label>
                    <div class="col-md-2">
                        <select id="HayvanTalepCinsi" class="form-control">
                            <option value="0">Seçiniz</option>
                            <option value="buyukbas">Büyükbaş</option>
                            <option value="kucukbas">Küçükbaş</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="HayvanTalepAdedi" class="form-control" autocomplete="off" maxlength="2" placeholder="hayvan adedi">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-3 control-label">&nbsp;</label>
                    <div class="col-md-4">
                        <button type="submit" class="btn green" onclick="YardimTalepEt()" style="width:100%">Yardım Talebinde Bulun</button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label">&nbsp;</label>
                    <div class="col-md-4"> &nbsp; </div>
                </div>

                <div class="form-group">
                    <div class="form-actions">
                        <div class="row">
                            <div class="col-md-offset-3 col-md-9">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        @Html.AntiForgeryToken()
    </div>
</div>
<script src="@Url.Content("~/DashboardTheme/assets/global/plugins/jquery.min.js")" type="text/javascript"></script>

<script>

    function YardimTalepEt() {

        var IsimSoyisim = document.getElementById("IsimSoyisim").value;
        var CepTelefonu = document.getElementById("CepTelefonu").value;
        var Email = document.getElementById("Email").value;
        var SehirId = document.getElementById("SehirId").value;
        var IlceId = document.getElementById("IlceId").value;
        var MahalleId = document.getElementById("MahalleId").value;
        var IsletmeAdi = document.getElementById("IsletmeAdi").value;
        var IsletmeKayitNo = document.getElementById("IsletmeKayitNo").value;

        if (IsimSoyisim == "") {
            ShowInfoFunctionBox("İsim Soyisim bilgisi girilmesi zorunludur...");
            return;
        }

        if (CepTelefonu == "") {
            ShowInfoFunctionBox("Cep Felefonu bilgisi girilmesi zorunludur...");
            return;
        }

        if (SehirId == "0") {
            ShowInfoFunctionBox("Adres bilgisi girilmesi zorunludur...");
            return;
        }

        var data = (
        {
            __RequestVerificationToken: $('input[name="__RequestVerificationToken"]').val(),
            'IsimSoyisim': IsimSoyisim,
            'CepTelefonu': CepTelefonu,
            'Email': Email,
            'SehirId': SehirId,
            'IlceId': IlceId,
            'MahalleId': MahalleId,
            'IsletmeAdi': IsletmeAdi,
            'IsletmeKayitNo': IsletmeKayitNo,
            'ImgBase64': ImgBase64
        });

        console.log("Data: " + JSON.stringify(data));

        $.ajax({
            type: "POST",
            url: '@Url.Action("ProfilBilgileriGuncelle", "Profil")',
            data: data,
            success: function (response) {

                $('#basic').modal('show');

                console.log("Response: " + JSON.stringify(response))
                if (response.IsSuccess) {
                    ShowInfoFunctionBox(response.Message);

                    $('#basic').modal('hide');
                }
                else {
                    ShowErrorMessageBox(response.Message);
                    $('#basic').modal('hide');
                }
            }
        });
    }

</script>

<script>

    function AdresIlChanged(val) {
        var data = {
            __RequestVerificationToken: $('input[name="__RequestVerificationToken"]').val(),
            'SehirId': val
        };

        $.ajax({
            type: "POST",
            url: '@Url.Action("IlceleriGetir", "Common")',
            data: data,
            success: function (response) {
                var ilcelerOp = "<option value=0>İlçe Seçiniz...</option>"
                for (var k in response) {
                    ilcelerOp += "<option value=" + response[k].Id + ">" + response[k].Value + "</option>"
                }
                document.getElementById("IlceId").innerHTML = ilcelerOp;
            }
        });
    }

    function AdresIlceChanged(val) {
        var data = {
            __RequestVerificationToken: $('input[name="__RequestVerificationToken"]').val(),
            'IlceId': val
        };

        $.ajax({
            type: "POST",
            url: '@Url.Action("MahalleleriGetir", "Common")',
            data: data,
            success: function (response) {
                var ilcelerOp = "<option value=0>Mahalle Seçiniz...</option>"
                for (var k in response) {
                    ilcelerOp += "<option value=" + response[k].Id + ">" + response[k].Value + "</option>"
                }
                document.getElementById("MahalleId").innerHTML = ilcelerOp;
            }
        });
    }

</script>
